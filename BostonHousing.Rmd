---
title: "Boston Housing Analysis and Predictive Modeling"
author: "Cameron"
date: "3/12/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

LoadLibraries = function() {
  library(ISLR)
  library(MASS)
  library(tidyverse)
  library(caret)
}

LoadLibraries()
attach(Boston)

```

## Initial Review

The first thing to do before any sort of modelling is to analyze the dataset and see what you can learn. Some of the things I'm looking for are things like what type of data is in each column (number, string, factors vs continuous, etc.) and whether there are any missing or obviously erroneous values in the data. First, here is the dictionary for our data


        CRIM - per capita crime rate by town
        ZN - proportion of residential land zoned for lots over 25,000 sq.ft.
        INDUS - proportion of non-retail business acres per town.
        CHAS - Charles River dummy variable (1 if tract bounds river; 0 otherwise)
        NOX - nitric oxides concentration (parts per 10 million)
        RM - average number of rooms per dwelling
        AGE - proportion of owner-occupied units built prior to 1940
        DIS - weighted distances to five Boston employment centres
        RAD - index of accessibility to radial highways
        TAX - full-value property-tax rate per $10,000
        PTRATIO - pupil-teacher ratio by town
        B - 1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town
        LSTAT - % lower status of the population
        MEDV - Median value of owner-occupied homes in $1000's

Next we look at some basic information about how its captured

```{r str}
str(Boston)
```

This shows us that all of our variables are numeric, with chas and rad being integers. As you can see from the dictionary above, chas is a dummy variable representing whether or not the tract bounds the river, so it's best described as binary in this instance. Rad is listed as an index of accessibility, so I take this as being equivalent to a continuous variable like the others.

```{r summarize}
summary(Boston)
```

This output gives me a few areas I'd like to investigate further. The zn and chas variables seem to have a lot of 0s so that's something I should follow up on. crim has a median and mean that are very far apart which is also interesting.

```{r histogram, message = FALSE}
library(reshape2)
library(ggplot2)
d <- melt(Boston)
ggplot(d,aes(x = value)) + 
    facet_wrap(~variable,scales = "free_x") + 
    geom_histogram() + ylim(0,150)
```

This output tells us some interesting things.  For example, the per capita crime rate by town (`crim`) along with `chas` and `zn` have an overwhelming count of 0s in it.  You'll have to trust me on this one as the bars don't show up due to the Y axis I defined to be able to see the shapes of the other histograms.  The average number of rooms per dwelling (`rm`) appears to be normally distributed, as does the median home value (`medv`) which is the intended response variable with this dataset.  `dis` and `lstat` also appear to have somewhat normal distributions but both have long right tails.

## Linear Model - the wrong way

``` {r initial_linear_model}
lm1 <- lm(medv~., data=Boston)
summary(lm1)
plot(lm1)
```

From this output we can see that a linear model on the variables as-is is inappropriate.  Looking at the Q-Q or the residuals vs fitted plot you can see that there's a problem with this model.  There's a clear U-shaped trend on the residuals and the Q-Q shows a lot of entries far away from the normal line.

Just for fun, though, let's try using a straight linear model with cross-validation to predict the housing values.  This will give us a good baseline for future tests to see if we're improving our model or not.

``` {r linear_cross_validation}
# Define training control
set.seed(123)
train.control <- trainControl(method = "repeatedcv", 
                              number = 10, repeats = 3)
# Train the model
model <- train(medv ~., data = Boston, method = "lm",
               trControl = train.control)
# Summarize the results
print(model)
```